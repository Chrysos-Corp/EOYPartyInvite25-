<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Christmas Party Crossword Code Guess</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&display=swap" rel="stylesheet">
  <style>
    body {
      background: #d45b1c;
      color: white;
      font-family: 'Roboto', Arial, sans-serif;
      text-align: center;
      padding: 40px 10px;
    }

    .crossword-img {
      max-width: 100%;
      width: 800px;
      border: 8px solid #fff;
      border-radius: 10px;
      box-shadow: 0 0 20px #b94e10;
      margin: 20px auto;
      display: block;
    }

    .input-area { margin: 30px 0; }

    input[type="text"] {
      padding: 16px;
      font-size: 1.5em;
      border-radius: 8px;
      border: 3px solid #fff;
      background: #fff7e1;
      color: #a84d00;
      width: 300px;
      text-align: center;
      font-family: 'Roboto', Arial, sans-serif;
    }

    button {
      padding: 16px 32px;
      font-size: 1.5em;
      border-radius: 8px;
      border: none;
      background: #a84d00;
      color: #fff;
      margin-left: 12px;
      cursor: pointer;
      font-family: 'Roboto', Arial, sans-serif;
      transition: transform 0.2s, background 0.2s;
    }
    button:hover { background: #8f3f00; transform: scale(1.05); }

    /* Keep the heading solid white (no animation) */
    h2 {
      font-size: 3.5em;
      font-weight: 900;
      letter-spacing: 2px;
      color: #ffffff;
    }

    /* Original invite look */
    .details {
      display: none;
      margin-top: 40px;
      background: #fff7e1;
      color: #a84d00;
      padding: 28px 20px;
      border-radius: 12px;
      box-shadow: 0 0 12px #fff;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
      font-size: 1.15em;
      font-family: 'Roboto', Arial, sans-serif;
    }

    .error {
      color: #fff;
      background: #d94f2b;
      padding: 8px 16px;
      border-radius: 8px;
      margin-top: 14px;
      display: inline-block;
      font-size: 1em;
      font-family: 'Roboto', Arial, sans-serif;
    }

    .invite-title {
      font-family: 'Arial Black', Arial, sans-serif;
      font-size: 2em;
      font-weight: bold;
      letter-spacing: 2px;
      margin-bottom: 0.5em;
      color: #a84d00;
      background: none;
      display: inline-block;
    }

    /* ===== Modal upgrade for the invite ===== */
    #partyDetails {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%) scale(0.92);
      display: none;
      z-index: 1001;
      max-width: 680px;
      width: 92vw;
      max-height: 80vh;
      overflow: auto;
      animation: popIn 360ms ease-out forwards;
    }
    @keyframes popIn {
      from { opacity: 0; transform: translate(-50%, -50%) scale(0.92); }
      to   { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }

    .backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.35);
      display: none;
      z-index: 1000;
    }

    #confettiCanvas {
      position: fixed;
      inset: 0;
      display: none;
      pointer-events: none;
      z-index: 1002;
    }

    /* ===== Envelope (centered, clickable) ===== */
    #envelope {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%) scale(0.98);
      display: none;                 /* shown after confetti */
      z-index: 1001;
      width: 640px;
      height: 430px;
      cursor: pointer;
      animation: envPop 380ms ease-out forwards, floaty 4s ease-in-out infinite;
    }
    @keyframes envPop {
      from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
      to   { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }
    @keyframes floaty {
      0%,100% { transform: translate(-50%, -50%) translateY(0); }
      50%     { transform: translate(-50%, -50%) translateY(-6px); }
    }

    /* Envelope pieces */
    .env-body {
      position: absolute;
      width: 100%;
      height: 70%;
      bottom: 0;
      background: #fff;
      border-radius: 0 0 12px 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      border: 3px solid #e8d8b8;
    }
    .env-flap {
      position: absolute;
      width: 100%;
      height: 60%;
      top: 0;
      background: linear-gradient(#ffe7b8, #f6d79a);
      clip-path: polygon(0 0, 100% 0, 50% 55%);
      border: 3px solid #e8d8b8;
      border-bottom: none;
      border-radius: 12px 12px 0 0;
    }
    .env-letter {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      top: 18%;
      width: 86%;
      background: #fff7e1;
      color: #a84d00;
      border-radius: 8px;
      padding: 12px 14px;
      border: 2px solid #e8d8b8;
      text-align: center;
      font-weight: 700;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .env-letter span {
  display: block;
  font-size: 0.85em;
  opacity: 0.8;
}

#envelope:focus { outline: none; }
#envelope:hover { filter: brightness(1.03); }

/* Gentle peek when hovering or focusing the envelope */
#envelope:hover .env-flap,
#envelope:focus .env-flap {
  transform: rotateX(22deg);
}

/* When opened: flap flips up, letter slides up */
#envelope.open .env-flap {
  transform: rotateX(180deg);
  filter: brightness(1.05);
}
#envelope.open .env-letter {
  transform: translate(-50%, -24px);
  opacity: 1;
}
    <audio id="victorySound"
       src="./victorysound.mp3?v=1"   <!-- cache-bust to avoid stale 404s -->
       preload="auto">
</audio>
  </style>
</head>
<body>
  <h2>Can You Guess Our Secret Party Spot?</h2>

  <img src="crossword.png" alt="Christmas Party Crossword" class="crossword-img" />

  <div class="input-area">
    <input id="codeInput" type="text" placeholder="Enter the secret code..." autocomplete="off" />
    <button onclick="checkCode()">Submit</button>
    <div id="errorMsg" class="error" style="display:none;"></div>
  </div>

  <!-- Invite (modal) -->
  <div id="partyDetails" class="details" role="dialog" aria-modal="true" aria-labelledby="inviteTitle">
    <button class="close-btn" title="Close" onclick="closeInvite()">âœ•</button>
    <div id="inviteTitle" class="invite-title">ðŸŽ‰YOU'RE INVITED!ðŸŽ‰</div>
    <p>
      <strong>Join us for our Christmas Party at Kingpin Bowling Norwood!</strong><br><br>
      Get ready for an afternoon of fun! Bowling, laser tag, and retro arcade games. Lunch is included, with beer, wine, and soft drinks provided. So bring your game face and your best moves.<br><br>
      <strong>Theme:</strong> 80sâ€“90s Throwback<br>
      Dress up in neon leggings, scrunchies, windbreakers, band tees, acid-wash jeans, chunky sneakers, bowling shirts, or vintage sportswear. The bolder, the better!<br><br>
      <strong>Event Info:</strong><br>
      â€¢ <strong>Date:</strong> Friday, 12th December<br>
      â€¢ <strong>Time:</strong> 1:30 PM â€“ 4:30 PM <span style="font-size:0.95em;">(1:15 PM arrival)</span><br>
      â€¢ <strong>Location:</strong> Kingpin Bowling Norwood (11 Osmond Terrace, Norwood SA 5067)<br>
      <br>
      Letâ€™s roll into the holidays with good times and great company!
    </p>
  </div>

  <!-- Backdrop, Confetti canvas, Envelope -->
  <div id="backdrop" class="backdrop" aria-hidden="true"></div>
  <canvas id="confettiCanvas"></canvas>

  <div id="envelope" tabindex="0" role="button" aria-label="Open invite">
    <div class="env-flap"></div>
    <div class="env-body"></div>
    <div class="env-letter">ðŸŽ‰ YOU'RE INVITED! ðŸŽ‰<span>Click to open</span></div>
  </div>

  <script>
    let attempts = 0;

    function checkCode() {
      const input = document.getElementById('codeInput').value.trim().toUpperCase();
      const validCodes = ["BOWLING", "KINGPIN", "KINGPIN BOWLING"];
      const errorMsg = document.getElementById('errorMsg');

      if (validCodes.includes(input)) {
        // 1) show backdrop
        document.getElementById('backdrop').style.display = 'block';
        document.body.style.overflow = 'hidden';
        errorMsg.style.display = 'none';
        attempts = 0;

  // 2) play victory sound + confetti â†’ then envelope
const victory = document.getElementById('victorySound');
if (victory) {
  try {
    victory.currentTime = 0;
    victory.play().catch(() => {}); // ignore autoplay rejections
  } catch (e) {
    console.warn('Could not play victory sound:', e);
  }
}

confettiBurst(1800, 160, () => {
  const env = document.getElementById('envelope');
  env.style.display = 'block';
  env.focus();
});

      } else {
        attempts++;
        hideAllOverlays();

        if (attempts === 3) {
          errorMsg.textContent = "Hint: Itâ€™s where balls roll, pins fall and legends are made!";
        } else {
          errorMsg.textContent = "Oops! That's not the secret location. Try again!";
        }
        errorMsg.style.display = 'block';
      }
    }

    // Clicking / Enter on envelope opens invite
    const envelope = document.getElementById('envelope');
    envelope.addEventListener('click', openInviteFromEnvelope);
    envelope.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        openInviteFromEnvelope();
      }
    });

    function openInviteFromEnvelope() {
      envelope.style.display = 'none';
      const partyDetails = document.getElementById('partyDetails');
      partyDetails.style.display = 'block';
    }

    function closeInvite() { hideAllOverlays(); }

    function hideAllOverlays() {
      document.getElementById('partyDetails').style.display = 'none';
      document.getElementById('backdrop').style.display = 'none';
      document.getElementById('confettiCanvas').style.display = 'none';
      document.getElementById('envelope').style.display = 'none';
      document.body.style.overflow = '';
    }

    // Close on backdrop click or ESC
    document.getElementById('backdrop').addEventListener('click', hideAllOverlays);
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') hideAllOverlays(); });

    // Enter to submit from input
    document.getElementById('codeInput').addEventListener('keydown', function(e) {
      if (e.key === 'Enter') checkCode();
    });

    /* ---------- Confetti (vanilla canvas), now with callback ---------- */
    function confettiBurst(duration = 2000, count = 140, onDone = () => {}) {
      const canvas = document.getElementById('confettiCanvas');
      const ctx = canvas.getContext('2d');

      function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      resize();
      window.addEventListener('resize', resize, { once:true });

      const colors = ['#FF6B6B', '#FFD93D', '#6BCB77', '#4D96FF', '#F7AEF8', '#FF9A9E'];
      const cx = canvas.width / 2;
      const cy = canvas.height / 2 - 40;
      const parts = Array.from({ length: count }).map(() => {
        const angle = Math.random() * Math.PI * 2;
        const speed = 5 + Math.random() * 6;
        return {
          x: cx, y: cy,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          ay: 0.18 + Math.random() * 0.2,
          size: 3 + Math.random() * 5,
          rot: Math.random() * Math.PI,
          vr: (Math.random() - 0.5) * 0.3,
          color: colors[(Math.random() * colors.length) | 0],
        };
      });

      let start;
      canvas.style.display = 'block';

      function frame(t) {
        if (!start) start = t;
        const elapsed = t - start;

        ctx.clearRect(0, 0, canvas.width, canvas.height);
        parts.forEach(p => {
          p.vy += p.ay;
          p.x += p.vx;
          p.y += p.vy;
          p.rot += p.vr;
          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate(p.rot);
          ctx.fillStyle = p.color;
          ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size);
          ctx.restore();
        });

        if (elapsed < duration) {
          requestAnimationFrame(frame);
        } else {
          canvas.style.display = 'none';
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          onDone(); // ðŸš€ show envelope
        }
      }
      requestAnimationFrame(frame);
    }
  </script>
</body>
</html>
